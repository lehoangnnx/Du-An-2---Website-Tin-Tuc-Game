function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$("#profile-image1").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}function ValidateSingleInput(e){if("file"==e.type){var t=e.value;if(t.length>0){for(var a=!1,r=0;r<_validFileExtensions.length;r++){var n=_validFileExtensions[r];if(t.substr(t.length-n.length,n.length).toLowerCase()==n.toLowerCase()){a=!0;break}}if(!a)return $("#msgerror").text("* Vui Lòng Chọn Đúng File Ảnh"),e.value="",!1}}return!0}$(function(){$("#profile-image1").on("click",function(){$("#profile-image-upload").click()})}),$("#profile-image-upload").change(function(){readURL(this)}),$(document).ready(function(){$("#btn-updateprofile").click(function(e){var t=$("#firstName").val(),a=$("#lastName").val(),r=$("#email").val(),n=$("#phoneNumber").val(),o=/^(01[2689]|09)[0-9]{8}$/,s=/^[A-Za-zÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚÝàáâãèéêìíòóôõùúýĂăĐđĨĩŨũƠơƯưẠ-ỹ]+$/,i=/[A-Z0-9._%+-]+@[A-Z0-9-]+.+.[A-Z]{2,4}/gim;return r.match(i)&&0!=r.length?t.match(s)||0==t.length?a.match(s)||0==a.length?n.match(o)||0==n.length?($("#msgerror").text(""),!0):($("#msgerror").text("* Vui Lòng Nhập Đúng Số Điện Thoại"),$("#lastName").focus(),e.preventDefault(),!1):($("#msgerror").text("* Vui Lòng Nhập Đúng Tên"),$("#lastName").focus(),e.preventDefault(),!1):($("#msgerror").text("* Vui Lòng Nhập Đúng Họ"),$("#firstName").focus(),e.preventDefault(),!1):($("#msgerror").text("* Vui Lòng Nhập Email"),$("#email").focus(),e.preventDefault(),!1)})});var _validFileExtensions=[".jpg",".jpeg",".bmp",".gif",".png"],timeout=null;$("#email").on("keyup keypress keydown",function(e){var t=$("#email").val(),a=/^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/;t.match(a)&&0!=t.length&&(clearTimeout(timeout),timeout=setTimeout(function(){var t={};t.email=$("#email").val();var a=$("meta[name='_csrf']").attr("content"),r=$("meta[name='_csrf_header']").attr("content");$(document).ajaxSend(function(e,t){t.setRequestHeader(r,a)}),$.ajax({type:"POST",contentType:"application/json",url:contextPath+"/validator-user",data:JSON.stringify(t),success:function(t){return"erroremail"==t?($("#msgerror").text("* Email Đã Tồn Tại"),$("#email").focus(),$("#btn-updateprofile").attr("disabled","disabled"),e.preventDefault(),!1):"successemail"==t?($("#msgerror").text(""),$("#btn-updateprofile").removeAttr("disabled"),!0):void 0},error:function(){alert("Lỗi ! Vui Lòng Kiểm Tra Lại")}})},10))}),$("#oldpassword").on("keyup keypress keydown",function(e){var t=$("#oldpassword").val();0!=t.length&&(clearTimeout(timeout),timeout=setTimeout(function(){var a={};a.password=t;var r=$("meta[name='_csrf']").attr("content"),n=$("meta[name='_csrf_header']").attr("content");$(document).ajaxSend(function(e,t){t.setRequestHeader(n,r)}),$.ajax({type:"POST",contentType:"application/json",url:contextPath+"/validator-password",data:JSON.stringify(a),success:function(t){return"errorpassword"==t?($("#msgerrorp").text("* Mật Khẩu Cũ Không Trùng Khớp"),$("#oldpassword").focus(),$("#btn-changepassword").attr("disabled","disabled"),e.preventDefault(),!1):"successpassword"==t?($("#msgerrorp").text(""),e.preventDefault(),!1):void 0},error:function(){alert("Lỗi ! Vui Lòng Kiểm Tra Lại")}})},500))}),$("#newpassword").on("keyup keypress keydown",function(){var e=$("#newpassword").val(),t=/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,16}$/;e.match(t)?$("#msgerrorp").text(""):($("#msgerrorp").text("Mật Khẩu Từ 6 -16 Ký Tự Bao Gồm Chữ, Số Và Ký Tự Đặc Biệt"),$("#btn-changepassword").attr("disabled","disabled"))}),$("#rnewpassword").on("keyup keypress keydown",function(){var e=$("#newpassword").val(),t=$("#rnewpassword").val();t.match(e)?($("#msgerrorp").text(""),$("#btn-changepassword").removeAttr("disabled")):($("#msgerrorp").text("Nhập Lại Mật Khẩu Không Trùng Khớp"),$("#btn-changepassword").attr("disabled","disabled"))}),$("#btn-changepassword").click(function(e){var t=$("#rnewpassword").val();return clearTimeout(timeout),timeout=setTimeout(function(){var a={};a.password=t;var r=$("meta[name='_csrf']").attr("content"),n=$("meta[name='_csrf_header']").attr("content");$(document).ajaxSend(function(e,t){t.setRequestHeader(n,r)}),$.ajax({type:"POST",contentType:"application/json",url:contextPath+"/changepassword",data:JSON.stringify(a),success:function(t){return"error"==t?($("#msgerrorp").text("* Lỗi! Vui Lòng Kiểm Tra Lại"),$("#oldpassword").focus(),$("#btn-changepassword").attr("disabled","disabled"),e.preventDefault(),!1):void("success"==t&&location.reload())},error:function(){alert("Lỗi ! Vui Lòng Kiểm Tra Lại")}})},500),e.preventDefault(),!1});